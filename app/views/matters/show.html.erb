<div class="w-100">
<% if @matter.user_belonging?(current_user) || @matter.user.id ==current_user.id %>
    <div class="container">
    <div class="chat bg-light p-4">
        <p class = "dm_list__content__link__box__name"><%= @matter.user.name %>とのチャット</p>
        <% if @comments.present? %>
          <% @comments.each do |comment| %>

            <% if comment.user_id == current_user.id %>
              <div class="message d-flex flex-row align-items-start mb-4">
                <% if comment.user.image.attached? %>
                  <%= image_tag comment.user.image, size: '40x40', class: 'message-icon rounded-circle bg-secondary text-white fs-3'%>
                <% else %>
                  <div class="message-icon rounded-circle bg-secondary text-white fs-3">
                    <i class="fas fa-user"></i>
                  </div>
                <% end %>
                <p class="message-text p-2 ms-2 mb-0 bg-warning">
                <%= comment.content %>
                </p><!-- .message-text -->
              </div><!-- .message -->
            <% else %>
              <div class="message d-flex flex-row-reverse align-items-start mb-4">
                  <% if comment.user.image.attached? %>
                    <%= image_tag comment.user.image, size: '40x40', class: 'message-icon rounded-circle bg-secondary text-white fs-3'%>
                  <% else %>
                    <div class="message-icon rounded-circle bg-secondary text-white fs-3">
                      <i class="fas fa-user"></i>
                    </div>
                  <% end %>
                <p class="message-text p-2 me-2 mb-0 bg-info">
                <%= comment.content %>
                </p><!-- .message-text -->
              </div><!-- .message -->
            <% end %>

          <% end %>
        <% else %>
        <h3 class="text-center">メッセージはまだありません</h3>
        <% end %>

        <div class="posts">
        <%= form_with(model:[@matter, @comment], method: :post) do |f| %>
            <%= f.text_area :content, :placeholder => "メッセージを入力して下さい" , :size => 70 %>
            <%= f.hidden_field :matter_id, value: @matter.id %>
            <br>
            <%= f.submit '投稿する', class: 'btn btn-primary' %>
        <% end %>
        </div>
    </div><!-- .chat -->
    </div><!-- .container -->
<% end %>

<br>
</div>